var lightIndex=-1;$(document).ready(function(){$(".wrap.wline").children("ul").after('<div class="hd_fix_center" style="display: none;"><div class="hd_fix_search clearfix" ><input type="text" maxlength="100" style="color:#333333;" url="" original="" id="fix_keyword" value="" name="keyword" class="keywordInput"><a class="hd_fix_searchBtn" href="javascript:searchTips();">ËÑ Ë÷</a><div style="display:none;" id="fix_searchSuggest" class="search_tips_result_new"></div></div></div>');var c=$("#word");var a=c.val();$("#fix_keyword").attr(a);var b=$("#searchSuggest");$("#fix_keyword").bind("focus keyup",function(d){c=$("#fix_keyword");b=$("#fix_searchSuggest");b.hide().css("background-color","white");keyUpClick(c,b,d)});$("#word").bind("focus keyup",function(d){c=$("#word");b=$("#searchSuggest");b.hide().css("background-color","white");keyUpClick(c,b,d)});$("#fix_keyword").bind("blur",function(d){b=$("#fix_searchSuggest");b.hide().css("background-color","white")});$("#word").bind("blur",function(d){b=$("#searchSuggest");b.hide().css("background-color","white")})});function keyUpClick(wordInput,searchSuggest,event){var basePath=top.location.href.match(/http.*?((search|www)\.111\.com\.cn)/)[1];var path="http://"+basePath+"/autoComplete/autoComplete.action";var myEvent=event||window.event;var keyCode=myEvent.keyCode;if(keyCode>=65&&keyCode<=90||keyCode==8||keyCode==46||keyCode==32||keyCode==49||keyCode==50||keyCode==51||keyCode==52||keyCode==53||keyCode==undefined){var str=wordInput.val();var newStr=str.replace(/(^\s*)|(\s*$)/g,"");var wordText=encodeURI(encodeURI(newStr));var u=jQuery("<ul>");if(wordText!=""){$.ajax({url:path,type:"POST",data:{word:wordText},cache:false,success:function(data){var dataList=eval("("+data+")");if(dataList.length>0){searchSuggest.html("");searchSuggest.append(u);$.each(dataList,function(i,autoComplete){var wordNode=autoComplete.word;createNode(wordNode,searchSuggest,u,wordInput,i)});searchSuggest.show()}},error:function(){alert("ËÑË÷Ê§°Ü£¡ ")}})}else{lightIndex=-1;var keys=$.cookie("keyWordsHistory");if(keys!=null){var arr=keys.split("|");var len=arr.length;if(len>0){searchSuggest.html("");searchSuggest.append(u);for(var i=0;i<len;i++){createNode(arr[i],searchSuggest,u,wordInput,i)}searchSuggest.append('<a onmousedown="clearRecord(this);" href="javascript:void(0);" class="hd_clear_history_record" style="display: block;">Çå³ý½üÆÚËÑË÷¼ÇÂ¼</a>');searchSuggest.show()}}}}else{if(keyCode==38||keyCode==40){var u=searchSuggest.children("ul");var autoNodes=u.children("li");if(keyCode==38){if(lightIndex==0){autoNodes.eq(lightIndex).css("background-color","white");lightIndex=autoNodes.length}if(lightIndex!=-1){autoNodes.eq(lightIndex).css("background-color","white");lightIndex--}else{lightIndex=autoNodes.length-1}autoNodes.eq(lightIndex).css("background-color","#FFFAEC")}if(keyCode==40){if(lightIndex!=-1){autoNodes.eq(lightIndex).css("background-color","white")}lightIndex++;if(lightIndex==autoNodes.length){lightIndex=0}autoNodes.eq(lightIndex).css("background-color","#FFFAEC")}searchSuggest.show()}else{if(keyCode==13){var u=searchSuggest.children("ul");var aquValue=u.children("li").eq(lightIndex).text();wordInput.val(aquValue);searchSuggest.hide();searchByEnterKey(wordInput)}}}}function createNode(d,g,e,h,f){var b=$("<li>");b.appendTo(e);var c=$("<a>").html(d);c.attr("href","javascript:void(0);");c.appendTo(b);b.mouseover(function(){if(lightIndex!=-1){e.children("li").eq(lightIndex).css("background-color","white")}e.children("li").eq(f).css("background-color","#FFFAEC");lightIndex=f});b.mouseout(function(){e.children("li").eq(f).css("background-color","white");lightIndex=-1});b.click(function(){var a=e.children("li").eq(f).text();h.val(a);lightIndex=-1;g.hide();search()})}function search(){var e=$("#word").val();if(e==null||e==""){$("#word").val("ÇëÊäÈë¹Ø¼ü´Ê");return}var a=e.replace(/(^\s*)|(\s*$)/g,"");var f="http://search.111.com.cn/";var d=encodeURI(encodeURI(a));var c=f+"search/search.action";var b=c+"?keyWord="+d;writeSearhHistory(a);window.location.href=b}function searchTips(){var e=$("#fix_keyword").val();if(e==null||e==""){$("#fix_keyword").val("ÇëÊäÈë¹Ø¼ü´Ê");return}var a=e.replace(/(^\s*)|(\s*$)/g,"");var f="http://search.111.com.cn/";var d=encodeURI(encodeURI(a));var c=f+"search/search.action";var b=c+"?keyWord="+d;writeSearhHistory(a);window.location.href=b}function searchByEnterKey(d){var f=d.val();if(f==null||f==""){d.val("ÇëÊäÈë¹Ø¼ü´Ê");return}var a=f.replace(/(^\s*)|(\s*$)/g,"");var g="http://search.111.com.cn/";var e=encodeURI(encodeURI(a));var c=g+"search/search.action";var b=c+"?keyWord="+e;writeSearhHistory(a);window.location.href=b}function writeSearhHistory(e){e=e.replace(/(^\s*)|(\s*$)/g,"");if(e!=null&&e!=""){var f=$.cookie("keyWordsHistory");if(f!=null&&f!=""){var b=f.split("|");var a=b.length;for(var d=0;d<a;d++){if(e==b[d].replace(/(^\s*)|(\s*$)/g,"")){return}}if(a>=5){var c=f.lastIndexOf("|");f=f.substring(1,c);alert(f)}f=e+"|"+f}else{f=e}$.cookie("keyWordsHistory",f,{path:"/",domain:".111.com.cn",expires:30})}}function clearRecord(a){$.cookie("keyWordsHistory",null,{path:"/",domain:".111.com.cn"});$(".hd_clear_history_record").parent().hide()};